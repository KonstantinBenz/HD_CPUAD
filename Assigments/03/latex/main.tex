% !TEX root = ./main.tex
% !TEX encoding = UTF-8 Unicode
\input{preamble}
\input{format}
\input{commands}

\begin{document}

\begin{Large}
    \textsf{\textbf{CPU Algorithm Design}} \\
    \\
    Exercise 3
\end{Large}
\vspace{1ex}
\textsf{\textbf{Students:}} \text{Vishal Mangukiya, Konstantin Benz} \\
\vspace{2ex}

\section*{3.1 Adapting reduce and transform}

The input containers in \texttt{reduce\_LoopUnrolling\_view.hpp} and 
\\
\texttt{transform\_LoopUnrolling\_view.hpp} were adapted to use range-based views as requested in the assignment.
In the reduction routines, the memory-backed containers were replaced with \texttt{std::views::repeat(1.0f, N)}, using \texttt{decltype(std::views::repeat(...))} to define a compatible member variable. This makes the code compute-bound and avoids unnecessary memory usage.
\\
For the transform routines, the input values were changed to \texttt{std::ranges::views::iota(0, N)}. Additionally, the output container \texttt{W} was replaced by a fixed-size \texttt{std::vector<Real>(256)} with modulo-indexed access to enable reuse of the output buffer and simulate non-memory-bound processing.

\textbf{Challenges encountered:}
\begin{itemize}
    \item Initially, the range variables \texttt{V} and \texttt{W} were only declared inside each function. However, since multiple functions need access to them, we had to promote them to class-level member variables.
    \item Using \texttt{std::views::repeat} or \texttt{std::views::iota} as class members required careful type declarations. Simple type aliases like \texttt{std::ranges::repeat\_view} or \texttt{std::ranges::iota\_view} caused type mismatch errors when assigning views with bounds.
    \item The correct approach was to use \texttt{decltype(std::views::repeat(...))} and \\
    \texttt{decltype(std::views::iota(...))} for the member declarations, as this ensured compatibility with the generated view types and compiler support on the cluster (GCC 14).
    \item Some loops were not vectorized according to compiler warnings. Since manual unrolling was explicitly requested in the assignment, we did not attempt further refactoring in these cases.
\end{itemize}

All modified functions were compiled and tested successfully via the targets \\
\texttt{reduceVbenchmarkUnroll} and \texttt{transformVbenchmarkUnroll}.

\pagebreak

\pagebreak

\section*{3.2 Adapting benchTransformUnrollLoopPeelingDirective}

\pagebreak

\section*{3.3 Adapting benchReduceUnrollTreeDirective}

\pagebreak

\section*{3.4 Adapting benchReduceUnrollSimdXHorizontal and benchReduceUnrollSimdXVertical}

\pagebreak

\section*{3.5 Benchmarking}

\end{document}
% !TEX root = ./main.tex
% !TEX encoding = UTF-8 Unicode
\input{preamble}
\input{format}
\input{commands}

\begin{document}

\begin{Large}
    \textsf{\textbf{CPU Algorithm Design}} \\
    \\
    Exercise 2
\end{Large}
\vspace{1ex}
\textsf{\textbf{Students:}} \text{Vishal Mangukiya, Konstantin Benz} \\
\vspace{2ex}

\section*{2.1 Performance Analysis of Reduce and Transform}

The benchmark results in Figure~\ref{fig:simd_reduce_output} and Table~\ref{tab:simd_reduce_output} show a clear performance improvement when using SIMD-based implementations over the baseline STL version.
The reduce benchmarks reveal that SIMD vectorization significantly increases throughput, particularly in custom-controlled vertical implementations.

The baseline STL version (\texttt{benchReduceStl}) achieves only about 9.93~GB/s, which serves as a reference point for comparison.
In contrast, SIMD-based and OpenMP-assisted variants such as \texttt{benchReduceSimdStl}, \texttt{benchReduceOmpIterator}, and \texttt{benchReduceOmpRange} all reach approximately 16~GB/s, demonstrating the benefit of vectorized addition and loop-level optimizations.
The highest performance is observed in \texttt{benchReduceSimdXVertical} with 19.71~GB/s, which clearly outperforms the other implementations and reflects efficient register-level parallelism.

Interestingly, aligned and horizontal SIMD versions perform slightly worse than the vertical one, suggesting that memory alignment does not always translate into higher throughput in practice.
Figure~\ref{fig:simd_transform_output} and Table~\ref{tab:simd_transform_output} show the transform benchmarks, which achieve significantly higher throughput overall.

Even the STL baseline version (\texttt{benchTransformStl}) reaches nearly 30~GB/s, indicating that this operation is already efficiently implemented and not severely bottlenecked by compute.
Most transform implementations—including loop variants, STL-based, and OpenMP-assisted—cluster tightly around 29--30~GB/s, showing only minor variation.

The top performer is \texttt{XsimdTransform} at 30.53~GB/s, closely followed by \\
\texttt{OmpSimdTransformRangeInnerLoop}.
This confirms that transform is likely memory-bound, and further parallelization or vectorization provides only limited gains.

Overall, the reduce benchmark benefits more clearly from explicit SIMD optimization, while transform shows high performance even without it due to its inherent memory-access characteristics.

\pagebreak

\begin{figure}[h!]
    \centering
    \includegraphics[width=0.9\linewidth]{img/simd_reduce_output.txt_ex02.png}
    \caption{Reduce benchmark results (throughput vs. implementation)}
    \label{fig:simd_reduce_output}
\end{figure}

\begin{table}[h!]
    \centering
    \begin{tabular}{|l|c|}
        \hline
        \textbf{Benchmark}         & \textbf{Throughput [GB/s]} \\
        \hline
        benchReduceStl             & 9.93                       \\
        benchReduceSimdStl         & 16.05                      \\
        benchReduceSimdXVertical   & \textbf{19.71}             \\
        benchReduceSimdXHorizontal & 12.75                      \\
        benchReduceSimdXAlign      & 12.67                      \\
        benchReduceOmpIterator     & 16.05                      \\
        benchReduceOmpRange        & 16.14                      \\
        \hline
    \end{tabular}
    \caption{Throughput results of reduce benchmarks}
    \label{tab:simd_reduce_output}
\end{table}

\pagebreak

\begin{figure}[h!]
    \centering
    \includegraphics[width=0.9\linewidth]{img/simd_transform_output.txt_ex02.png}
    \caption{Transform benchmark results (throughput vs. implementation)}
    \label{fig:simd_transform_output}
\end{figure}

\begin{table}[h!]
    \centering
    \begin{tabular}{|l|c|}
        \hline
        \textbf{Benchmark}                  & \textbf{Throughput [GB/s]} \\
        \hline
        benchTransformStl                   & 29.82                      \\
        benchTransformSimdStl               & 29.78                      \\
        benchTransformRangeInnerLoop        & 29.75                      \\
        benchTransformIteratorInnerLoop     & 29.77                      \\
        benchOmpSimdTransformRangeInnerLoop & \textbf{30.51}             \\
        benchXsimdTransform                 & \textbf{30.53}             \\
        benchXsimdTransformAligned          & 29.10                      \\
        \hline
    \end{tabular}
    \caption{Throughput results of transform benchmarks}
    \label{tab:simd_transform_output}
\end{table}

\pagebreak

\section*{2.2 Adapting reduce and transform}



\end{document}